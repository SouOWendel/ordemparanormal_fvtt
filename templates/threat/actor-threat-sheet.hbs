<section class="{{actor.type}} threat flexcol" id="threat" autocomplete="off">
    {{!-- HEADER --}}
    <header class="sheet-header-op">
			<div class="header-identify align-center flex">
				<img class="threat-profile-img" src="{{actor.img}}" data-edit="img" data-action="onEditImage" title="{{actor.name}}" />
					<div class="flexcol" style="flex: 1; justify-content: flex-start; gap: 5px; min-width: 200px;">
						<div class="flexrow flex-center">
							<h1 class="charname" style="margin: 0; flex: 1;">
								<input name="name" type="text" value="{{actor.name}}" placeholder="{{ localize 'op.threatName' }}" 
								style="text-align: center; font-weight: bold; font-size: 24px; width: 100%;" />
							</h1>
						</div>

                <div class="header-stats-row">
                    <div style="background: rgba(0, 0, 0, 0.05); border-radius: 5px; border: 1px solid #ccc; padding: 2px 5px; flex: 0 0 60px; display: flex; flex-direction: column; justify-content: center; align-items: center;">
                        <label style="font-weight: bold; font-size: 11px; color: #333; margin-bottom: 2px; text-align: center; width: 100%;">{{localize 'op.VD'}}</label>
                        <input type="number" name="system.attributes.vd.value" value="{{system.attributes.vd.value}}" data-dtype="Number"
                               style="width: 100%; text-align: center; font-size: 16px; font-weight: bold; border: none; background: transparent; height: 20px; padding: 0;"/>
                    </div>

                    <div class="disturbing-presence">
                        <label style="font-weight: bold; font-size: 14px; white-space: nowrap; color: #333;">{{localize 'op.attPre'}}:</label>
                        
                        <div style="display: flex; align-items: center; gap: 5px;">
                            <label style="font-size: 11px; color: #555; font-weight: bold;">DT</label>
                            <input type="number" name="system.disturbingPresence.dt" value="{{system.disturbingPresence.dt}}" 
                                   style="height: 22px; font-size: 12px; width: 40px; text-align: center; border: 1px solid #999; border-radius: 3px; background: rgba(255,255,255,0.5);" placeholder="0">
                        </div>

                        <div style="display: flex; align-items: center; gap: 5px;">
                            <label style="font-size: 11px; color: #555; font-weight: bold;">{{localize 'op.damage'}}</label>
                            <input type="text" name="system.disturbingPresence.mentalDamage" value="{{system.disturbingPresence.mentalDamage}}" 
                                   style="height: 22px; font-size: 12px; width: 80px; text-align: center; border: 1px solid #999; border-radius: 3px; background: rgba(255,255,255,0.5);" placeholder="Ex: 2d6">
                            
                            <i class="fa-solid fa-brain rollable pointer" data-action="onRollMentalDamage" title="{{localize 'op.rollMentalDamage'}}" 
                               style="color: #6a0dad; font-size: 16px; margin-left: 4px;"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="header-fields" style="margin-top: 2px;">
					<div class="resources flexrow">
						<div class="resource flex-group-center">
							<label class="resource-label"> {{localize 'op.PV'}} </label>
							<div class="resource-content flexrow flex-center flex-between">
								<input type="text" name="system.attributes.hp.value" value="{{system.attributes.hp.value}}" data-dtype="Number" />
								<span> / </span>
								<input type="text" name="system.attributes.hp.max" value="{{system.attributes.hp.max}}" data-dtype="Number" />
							</div>
						</div>
						<div class="resources flexrow" style="margin-top: 5px; flex-wrap: wrap;">
							<div class="resource flex-group-center" style="flex: 1; min-width: 100px;">
								<label class="resource-label">{{localize 'op.defense'}}</label>
								<div class="resource-content flexrow flex-center flex-between">
									<input type="text" name="system.defense.value" value="{{system.defense.value}}" data-dtype="Number"/>
								</div>
							</div>
							<div class="resource flex-group-center" style="flex: 1; min-width: 100px;">
								<label class="resource-label">{{localize 'op.deslocamento'}}</label>
								<div class="resource-content flexrow flex-center flex-between">
									<input type="text" name="system.attributes.movement.walk" value="{{system.attributes.movement.walk}}" data-dtype="String"  />
								</div>
							</div>
            </div>
					</div>

					<div class="resources flexrow" style="margin-top: 5px; margin-bottom: 5px; gap: 10px; flex-wrap: wrap;">
						<div class="resource flex-group-center" style="flex: 1 0 30%;">
							<label class="resource-label">{{localize 'op.type'}}</label>
							<div class="resource-content">
								<select name="system.details.creatureType" style="width: 100%; text-align: center;">
									{{selectOptions threatTypes selected=system.details.creatureType localize=true}}
								</select>
							</div>
						</div>
						<div class="resource flex-group-center" style="flex: 1 0 30%;">
							<label class="resource-label">{{localize 'op.element'}}</label>
							<div class="resource-content">
								<select name="system.details.element" style="width: 100%; text-align: center;">
									{{selectOptions elements selected=system.details.element localize=true}}
								</select>
							</div>
						</div>
						<div class="resource flex-group-center" style="flex: 1 0 30%;">
							<label class="resource-label">{{localize 'op.size'}}</label>
							<div class="resource-content">
								<select name="system.details.size" style="width: 100%; text-align: center;">
									{{selectOptions threatSizes selected=system.details.size localize=true}}
								</select>
							</div>
						</div>
					</div>

            <div class="resources flexrow" style="flex-wrap: wrap; gap: 5px;">
							<div class="resource flex-group-center" style="flex: 1; min-width: 50px;">
								<label class="resource-label rollable pointer" data-action="onRollSkillCheck" data-key="dex">{{localize 'op.attDex'}}</label>
								<div class="resource-content flexrow flex-center flex-between">
									<input type="text" name="system.attributes.dex.value" value="{{system.attributes.dex.value}}" data-dtype="Number" />
								</div>
							</div>
							<div class="resource flex-group-center" style="flex: 1; min-width: 50px;">
								<label class="resource-label rollable pointer" data-action="onRollSkillCheck" data-key="str">{{localize 'op.attStr'}}</label>
								<div class="resource-content flexrow flex-center flex-between">
									<input type="text" name="system.attributes.str.value" value="{{system.attributes.str.value}}" data-dtype="Number" />
								</div>
							</div>
							<div class="resource flex-group-center" style="flex: 1; min-width: 50px;">
								<label class="resource-label rollable pointer" data-action="onRollSkillCheck" data-key="int">{{localize 'op.attInt'}}</label>
								<div class="resource-content flexrow flex-center flex-between">
									<input type="text" name="system.attributes.int.value" value="{{system.attributes.int.value}}" data-dtype="Number" />
								</div>
							</div>
							<div class="resource flex-group-center" style="flex: 1; min-width: 50px;">
								<label class="resource-label rollable pointer" data-action="onRollSkillCheck" data-key="pre">{{localize 'op.attPre'}}</label>
								<div class="resource-content flexrow flex-center flex-between">
									<input type="text" name="system.attributes.pre.value" value="{{system.attributes.pre.value}}" data-dtype="Number" />
								</div>
							</div>
							<div class="resource flex-group-center" style="flex: 1; min-width: 50px;">
								<label class="resource-label rollable pointer" data-action="onRollSkillCheck" data-key="vit">{{localize 'op.attVit'}}</label>
								<div class="resource-content flexrow flex-center flex-between">
									<input type="text" name="system.attributes.vit.value" value="{{system.attributes.vit.value}}" data-dtype="Number" />
								</div>
							</div>
            </div>

            <div class="resources threat-skills-container">
							{{#each system.skills as |skill key|}}
								<div class="resource flex-group-center" style="display: flex; flex-direction: column; align-items: center; justify-content: flex-end; width: 100%;">
									<label for="system.skills.{{key}}.value" data-action="onRollSkillCheck" class="resource-label rollable flexlarge align-left skill-name"
									data-label="{{skill.label}}" data-key="{{key}}" data-rollType="skill">{{skill.label}}</label>
									<div class="item-space item-prop item-editable-resource">
										{{#if @root.owner}}
											<a class="adjustment-button" data-action="decrease" data-property="system.skills.{{key}}.degree.value">
												<i class="fas fa-minus"></i>
											</a>
										{{/if}}
										<input type="number" value="{{skill.degree.value}}" placeholder="0" data-dtype="Number"
											data-name="system.skills.{{key}}.degree.value" inputmode="numeric" pattern="[0-9+=\-]*" min="0">
										{{#if @root.owner}}
											<a class="adjustment-button" data-action="increase" data-property="system.skills.{{key}}.degree.value">
												<i class="fas fa-plus"></i>
											</a>
										{{/if}}
									</div>
								</div>
							{{/each}}
            </div>

						<div class="threat-tags flexrow">
							<div class="resources flexrow" style="margin-top: 5px;">
								<div class="resource flex-group-center">
									<label class="resource-label">
										<a class="config-button" data-action="openResistanceConfig" title="{{localize 'op.resistancesTitle'}}" style="text-decoration: none; color: inherit;">
											<i class="fas fa-shield-alt"></i> {{localize 'op.resistances'}} <i class="fas fa-cog" style="font-size: 0.8em; opacity: 0.5;"></i>
										</a>
									</label>
										
									<div class="resource-content resistance-container-grid">
										{{#each viewResistances as |res key|}}
											{{#if res.isVisible}}
												<span class="resistance-tag" title="{{res.translatedLabel}}">
													<span class="resistance-tag-label">{{res.translatedLabel}}</span>
													<span class="resistance-tag-values">
														{{#if (gt res.value 0)}}<span class="resistance-tag-value">{{res.value}}</span>{{/if}}
														{{#if res.immune}}<i class="fas fa-shield-alt resistance-tag-immune" title="{{localize 'op.immune'}}"></i>{{/if}}
														{{#if res.vulnerable}}<i class="fas fa-heart-broken resistance-tag-vulnerable" title="{{localize 'op.vulnerable'}}"></i>{{/if}}
													</span>
												</span>
											{{/if}}
										{{/each}}
									</div>
								</div>
							</div>

							<div class="resources flexrow" style="margin-top: 5px;">
								<div class="resource flex-group-center">
									<label class="resource-label">
										<a class="config-button" data-action="openTraitsConfig" title="{{localize 'op.traitsTitle'}}" style="text-decoration: none; color: inherit;">
											<i class="fa-solid fa-list"></i> {{localize 'op.traitsLabel'}} <i class="fas fa-cog" style="font-size: 0.8em; opacity: 0.5;"></i>
										</a>
									</label>
										
									<div class="resource-content traits-container-grid">
										{{#each viewTraits as |trait key|}}
											{{#if trait.isVisible}}
												<span class="traits-tag" title="{{trait.translatedLabel}}">
													<span class="traits-tag-label">
														{{trait.translatedLabel}}
													</span>
												</span>
											{{/if}}
										{{/each}}
									</div>
								</div>
							</div>
						</div>
        </div>
    </header>
</section>